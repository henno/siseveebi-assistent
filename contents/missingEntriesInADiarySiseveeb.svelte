<script context="module" lang="ts">
    import type {
        PlasmoCSConfig,
        PlasmoGetInlineAnchor,
        PlasmoMountShadowHost,
        PlasmoGetStyle
    } from "plasmo"
    import {Timetable} from "~contents/Timetable";
    import {Diary} from "~contents/Diary";

    export const getStyle: PlasmoGetStyle = () => {
        const style = document.createElement("style")
        style.textContent = `
    dt {
        font-weight: bold;
        line-height: 1.5;
        box-sizing: border-box;
        display: block;
        font-size: 13px;
        font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
        color: #333;
        background-color: #fff;
        -webkit-tap-highlight-color: rgba(0,0,0,0);
        -ms-text-size-adjust: 100%;
        -webkit-text-size-adjust: 100%;
    }
  `
        return style
    }


    export const config: PlasmoCSConfig = {
        matches: ["https://siseveeb.voco.ee/kutseope/oppetoo/paevik/taitmine*"]
    }

    console.log(1)
    export const getInlineAnchor: PlasmoGetInlineAnchor = () =>
        document.querySelector("#daybook_done_info_panel_all > div.panel-body")


    export const mountShadowHost: PlasmoMountShadowHost = ({
                                                               shadowHost,
                                                               anchor,
                                                               observer
                                                           }) => {
        anchor.element.appendChild(shadowHost)
        observer.disconnect() // OPTIONAL DEMO: stop the observer as needed
    }


</script>

<script>
    import {onMount} from 'svelte';
    export let anchor;
    let missingEntries = [];
    onMount(async () => {
        missingEntries = await Timetable.getMissingEntriesAsync()
        console.log(missingEntries)
    });
</script>

<div>
    <h1>P채evikust puuduvad tunnid:</h1>
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Kuup채ev</th>
            <th>Tunnid</th>
            <th>T체체p</th>
        </tr>
        </thead>
        <tbody>
        {#each missingEntries as missingEntry, i}
            <tr>
                <td>{missingEntry.day}</td>
                <td>{missingEntry.hours}</td>
                <td>{missingEntry.type}</td>
            </tr>
        {/each}
        </tbody>
    </table>
</div>
